<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Quiz Management System</title>
    <link rel="stylesheet" href="admin-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <i class="fas fa-shield-alt"></i>
                <h1>Admin Dashboard</h1>
                <p>Quiz Management System</p>
            </div>
            <form id="adminLoginForm" class="login-form">
                <div class="form-group">
                    <label for="adminEmail">Email:</label>
                    <input type="email" id="adminEmail" placeholder="admin@quiz.com" required>
                </div>
                <div class="form-group">
                    <label for="adminPassword">Password:</label>
                    <input type="password" id="adminPassword" placeholder="admin123" required>
                </div>
                <button type="submit" class="btn-login">
                    <i class="fas fa-sign-in-alt"></i>
                    Đăng nhập
                </button>
            </form>
            <div id="loginError" class="error-message"></div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboardSection" class="dashboard-container hidden">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-tachometer-alt"></i>
                <span>Admin Panel</span>
            </div>
            <ul class="sidebar-menu">
                <li class="menu-item active" data-section="overview">
                    <i class="fas fa-chart-pie"></i>
                    <span>Tổng quan</span>
                </li>
                <li class="menu-item" data-section="teachers">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Giáo viên</span>
                </li>
                <li class="menu-item" data-section="students">
                    <i class="fas fa-user-graduate"></i>
                    <span>Học sinh</span>
                </li>
                <li class="menu-item" data-section="classes">
                    <i class="fas fa-school"></i>
                    <span>Lớp học</span>
                </li>
                <li class="menu-item" data-section="quizsets">
                    <i class="fas fa-question-circle"></i>
                    <span>Bộ đề</span>
                </li>
                <li class="menu-item" data-section="questions">
                    <i class="fas fa-question"></i>
                    <span>Câu hỏi</span>
                </li>
                <li class="menu-item" data-section="results">
                    <i class="fas fa-chart-bar"></i>
                    <span>Kết quả</span>
                </li>
            </ul>
            <div class="sidebar-footer">
                <button id="logoutBtn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                    Đăng xuất
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <h2 id="sectionTitle">Tổng quan</h2>
                <div class="header-actions">
                    <button id="refreshBtn" class="btn-refresh">
                        <i class="fas fa-sync-alt"></i>
                        Làm mới
                    </button>
                </div>
            </header>

            <!-- Overview Section -->
            <section id="overviewSection" class="content-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalTeachers">0</h3>
                            <p>Giáo viên</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalStudents">0</h3>
                            <p>Học sinh</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-school"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalClasses">0</h3>
                            <p>Lớp học</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalQuizSets">0</h3>
                            <p>Bộ đề</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Teachers Section -->
            <section id="teachersSection" class="content-section hidden">
                <div class="section-header">
                    <button id="addTeacherBtn" class="btn-primary">
                        <i class="fas fa-plus"></i>
                        Thêm giáo viên
                    </button>
                </div>
                <div class="table-container">
                    <table id="teachersTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Tên đăng nhập</th>
                                <th>Họ tên</th>
                                <th>Ngày tạo</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="teachersTableBody">
                            <!-- Teachers data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Students Section -->
            <section id="studentsSection" class="content-section hidden">
                <div class="section-header">
                    <div class="search-container">
                        <input type="text" id="studentSearch" placeholder="Tìm kiếm học sinh...">
                        <button id="searchStudentsBtn" class="btn-search">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="studentsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Tên đăng nhập</th>
                                <th>Họ tên</th>
                                <th>Lớp học</th>
                                <th>Ngày tạo</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <!-- Students data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Classes Section -->
            <section id="classesSection" class="content-section hidden">
                <div class="section-header">
                    <button id="addClassBtn" class="btn-primary">
                        <i class="fas fa-plus"></i>
                        Tạo lớp mới
                    </button>
                </div>
                <div class="table-container">
                    <table id="classesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Mã lớp</th>
                                <th>Tên lớp</th>
                                <th>Giáo viên</th>
                                <th>Số học sinh</th>
                                <th>Ngày tạo</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="classesTableBody">
                            <!-- Classes data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Quiz Sets Section -->
            <section id="quizsetsSection" class="content-section hidden">
                <div class="section-header">
                    <button id="addQuizSetBtn" class="btn-primary">
                        <i class="fas fa-plus"></i>
                        Tạo bộ đề mới
                    </button>
                </div>
                <div class="table-container">
                    <table id="quizSetsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Tên bộ đề</th>
                                <th>Lớp học</th>
                                <th>Số câu hỏi</th>
                                <th>Thời gian (phút)</th>
                                <th>Trạng thái</th>
                                <th>Ngày tạo</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="quizSetsTableBody">
                            <!-- Quiz sets data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Questions Section -->
            <section id="questionsSection" class="content-section hidden">
                <div class="section-header">
                    <h3>Quản lý Câu hỏi</h3>
                    <div class="header-actions">
                        <button id="addQuestionBtn" class="btn-primary">
                            <i class="fas fa-plus"></i>
                            Thêm câu hỏi
                        </button>
                        <select id="categoryFilter" class="filter-select">
                            <option value="">Tất cả chủ đề</option>
                            <option value="Web">Web</option>
                            <option value="Database">Database</option>
                            <option value="Networking">Networking</option>
                            <option value="DSA">DSA</option>
                            <option value="Algorithm">Algorithm</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table id="questionsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Loại</th>
                                <th>Câu hỏi</th>
                                <th>Chủ đề</th>
                                <th>Đáp án</th>
                                <th>Ngày tạo</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="questionsTableBody">
                            <!-- Questions data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="content-section hidden">
                <div class="section-header">
                    <h3>Kết quả Quiz</h3>
                    <div class="filter-container">
                        <select id="classFilter" class="filter-select">
                            <option value="">Tất cả lớp</option>
                        </select>
                        <select id="quizFilter" class="filter-select">
                            <option value="">Tất cả bộ đề</option>
                        </select>
                        <input type="date" id="dateFrom" class="date-input">
                        <input type="date" id="dateTo" class="date-input">
                        <button id="exportResultsBtn" class="btn-secondary">
                            <i class="fas fa-download"></i>
                            Xuất Excel
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="resultsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Học sinh</th>
                                <th>Lớp học</th>
                                <th>Bộ đề</th>
                                <th>Điểm</th>
                                <th>Thời gian</th>
                                <th>Ngày làm</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                            <!-- Results data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add Teacher Modal -->
    <div id="addTeacherModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Thêm Giáo viên</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="addTeacherForm" class="modal-form">
                <div class="form-group">
                    <label for="teacherEmail">Email:</label>
                    <input type="email" id="teacherEmail" required>
                </div>
                <div class="form-group">
                    <label for="teacherPassword">Mật khẩu:</label>
                    <input type="password" id="teacherPassword" required>
                </div>
                <div class="form-group">
                    <label for="teacherUsername">Tên đăng nhập:</label>
                    <input type="text" id="teacherUsername" required>
                </div>
                <div class="form-group">
                    <label for="teacherFullName">Họ và tên:</label>
                    <input type="text" id="teacherFullName" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary modal-cancel">Hủy</button>
                    <button type="submit" class="btn-primary">Thêm</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Class Modal -->
    <div id="addClassModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tạo Lớp học</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="addClassForm" class="modal-form">
                <div class="form-group">
                    <label for="className">Tên lớp:</label>
                    <input type="text" id="className" required>
                </div>
                <div class="form-group">
                    <label for="classTeacher">Giáo viên:</label>
                    <select id="classTeacher" required>
                        <option value="">Chọn giáo viên</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary modal-cancel">Hủy</button>
                    <button type="submit" class="btn-primary">Tạo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Quiz Set Modal -->
    <div id="addQuizSetModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Tạo Bộ đề</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="addQuizSetForm" class="modal-form">
                <div class="form-group">
                    <label for="quizSetTitle">Tên bộ đề:</label>
                    <input type="text" id="quizSetTitle" required>
                </div>
                <div class="form-group">
                    <label for="quizSetClass">Lớp học:</label>
                    <select id="quizSetClass" required>
                        <option value="">Chọn lớp</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="questionCount">Số câu hỏi:</label>
                        <input type="number" id="questionCount" min="1" max="20" value="5" required>
                    </div>
                    <div class="form-group">
                        <label for="timeLimit">Thời gian (phút):</label>
                        <input type="number" id="timeLimit" min="1" max="60" value="10" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Chọn câu hỏi:</label>
                    <div id="questionsChecklist" class="questions-checklist">
                        <!-- Questions will be loaded here -->
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary modal-cancel">Hủy</button>
                    <button type="submit" class="btn-primary">Tạo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Question Modal -->
    <div id="addQuestionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Thêm Câu hỏi</h3>
                <button class="modal-close">&times;</button>
            </div>
            <form id="addQuestionForm" class="modal-form">
                <div class="form-group">
                    <label for="questionType">Loại câu hỏi:</label>
                    <select id="questionType" required>
                        <option value="tf">Đúng/Sai</option>
                        <option value="mcq">Trắc nghiệm</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="questionText">Nội dung câu hỏi:</label>
                    <textarea id="questionText" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="questionCategory">Chủ đề:</label>
                    <input type="text" id="questionCategory" required>
                </div>
                <div id="tfOptions" class="question-options">
                    <label>Đáp án:</label>
                    <div class="radio-group">
                        <label><input type="radio" name="tfAnswer" value="true"> Đúng</label>
                        <label><input type="radio" name="tfAnswer" value="false"> Sai</label>
                    </div>
                </div>
                <div id="mcqOptions" class="question-options hidden">
                    <label>Lựa chọn:</label>
                    <input type="text" id="option1" placeholder="Lựa chọn 1" required>
                    <input type="text" id="option2" placeholder="Lựa chọn 2" required>
                    <input type="text" id="option3" placeholder="Lựa chọn 3" required>
                    <input type="text" id="option4" placeholder="Lựa chọn 4" required>
                    <label for="correctAnswer">Đáp án đúng:</label>
                    <select id="correctAnswer" required>
                        <option value="0">Lựa chọn 1</option>
                        <option value="1">Lựa chọn 2</option>
                        <option value="2">Lựa chọn 3</option>
                        <option value="3">Lựa chọn 4</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary modal-cancel">Hủy</button>
                    <button type="submit" class="btn-primary">Thêm</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Student Modal -->
    <div id="editStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chỉnh sửa thông tin học sinh</h3>
                <button id="closeEditStudentModal" class="modal-close">&times;</button>
            </div>
            <form id="editStudentForm" class="modal-form">
                <input type="hidden" id="editStudentId">
                <div class="form-group">
                    <label for="editStudentUsername">Tên đăng nhập:</label>
                    <input type="text" id="editStudentUsername" required>
                </div>
                <div class="form-group">
                    <label for="editStudentFullName">Họ tên:</label>
                    <input type="text" id="editStudentFullName" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditStudentModal()">Hủy</button>
                    <button type="submit" class="btn-primary">Cập nhật</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Teacher Modal -->
    <div id="editTeacherModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chỉnh sửa thông tin giáo viên</h3>
                <button id="closeEditTeacherModal" class="modal-close">&times;</button>
            </div>
            <form id="editTeacherForm" class="modal-form">
                <input type="hidden" id="editTeacherId">
                <div class="form-group">
                    <label for="editTeacherUsername">Tên đăng nhập:</label>
                    <input type="text" id="editTeacherUsername" required>
                </div>
                <div class="form-group">
                    <label for="editTeacherFullName">Họ tên:</label>
                    <input type="text" id="editTeacherFullName" required>
                </div>
                <div class="form-group">
                    <label for="editTeacherEmail">Email:</label>
                    <input type="email" id="editTeacherEmail" readonly>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditTeacherModal()">Hủy</button>
                    <button type="submit" class="btn-primary">Cập nhật</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Đang tải...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="admin-dashboard.js"></script>
</body>
</html>
